# PowerShell language configuration
languages:
  powershell:
    file_associations:
      "*.ps1": "powershell"
      "*.psm1": "powershell"
      "*.psd1": "powershell"
    
    settings:
      "[powershell]":
        editor.formatOnSave: true
        editor.tabSize: 4
        editor.insertSpaces: true
      
      powershell.codeFormatting.preset: "OTBS"
      powershell.scriptAnalysis.enable: true
    
    required_extensions:
      - "ms-vscode.powershell"
    
    tasks:
      - label: "PowerShell: Analyze"
        type: "shell"
        command: "pwsh"
        args: ["-Command", "Invoke-ScriptAnalyzer", "-Path", ".", "-Recurse"]
        group: "test"
      
      - label: "PowerShell: Test"
        type: "shell"
        command: "pwsh"
        args: ["-Command", "Invoke-Pester"]
        group: "test"
    
    launch_configurations:
      - name: "PowerShell: Launch Current File"
        type: "PowerShell"
        request: "launch"
        script: "${file}"
    
    linting:
      enabled: true
      tools:
        - "PSScriptAnalyzer"