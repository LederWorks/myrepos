{%- set languages_config = load_yaml('config/languages.yaml') -%}
{%- set platforms_config = load_yaml('config/platforms.yaml') -%}
{%- set clients_config = load_yaml('config/clients.yaml') -%}
{%- set all_settings = {} -%}

{# Base settings #}
{%- set _ = all_settings.update({
  "files.exclude": {
    "**/.git": true,
    "**/.DS_Store": true
  },
  "files.watcherExclude": {
    "**/.git/objects/**": true,
    "**/.git/subtree-cache/**": true,
    "**/node_modules/*/**": true
  }
}) -%}

{# Merge language settings #}
{%- for language in metadata.languages -%}
  {%- if language in languages_config and 'settings' in languages_config[language] -%}
    {%- set _ = all_settings.update(languages_config[language].settings) -%}
  {%- endif -%}
{%- endfor -%}

{# Merge platform settings #}
{%- if platform in platforms_config and 'settings' in platforms_config[platform] -%}
  {%- set _ = all_settings.update(platforms_config[platform].settings) -%}
{%- endif -%}

{# Merge client settings #}
{%- set client_key = client if client in clients_config else 'unknown' -%}
{%- if 'settings' in clients_config[client_key] -%}
  {%- set _ = all_settings.update(clients_config[client_key].settings) -%}
{%- endif -%}

{{ all_settings | tojson(indent=2) }}